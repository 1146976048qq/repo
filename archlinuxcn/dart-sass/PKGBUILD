# Maintainer: Thayne McCombs <astrothayne@gmail.com>
# Contributor: Ariel AxionL <i at axionl dot me>

pkgname=dart-sass
pkgver=1.22.10
pkgrel=1
pkgdesc="Sass makes CSS fun again (canonical implementation)"
arch=('any')
url="https://github.com/sass/dart-sass"
license=('MIT')
depends=('dart' 'bash')
provides=('sass')
conflicts=('ruby-sass')
source=("${pkgname}-${pkgver}::https://github.com/sass/$pkgname/archive/$pkgver.tar.gz" "sass.sh")
sha256sums=('d24cde281e73c01a2d6104ce64df3e1ecd8595ef0f0b9f9927baaa69c97b2bfd'
            'ea2877ea2e2287b4d496ff892b927f24e963da3e049ac6e47070006497066c08')

build() {
  cd "${pkgname}-${pkgver}"
  pub get
  # Create snapshot
  # This doesn't use the grinder script so it is compatible with dart 2
  dart --snapshot=sass.snapshot --snapshot-kind=app-jit bin/sass.dart tool/app-snapshot-input.scss > /dev/null
}

package() {
  install -Dm755 sass.sh "${pkgdir}/usr/bin/sass"
  cd "${pkgname}-${pkgver}"
  install -Dm644 sass.snapshot "${pkgdir}/usr/lib/sass/app.snapshot"
  install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}

# vim:set ts=4 sw=4 et:
