# Maintainer: Christian Hesse <mail@eworm.de>

pkgname=opera-developer
pkgver=28.0.1738.0
pkgrel=3
pkgdesc='A fast and secure web browser and Internet suite - developer stream'
arch=('x86_64')
url='http://www.opera.com/browser/'
license=('custom:opera')
depends=('alsa-lib' 'nss' 'gtk2' 'gconf' 'libxss' 'libxtst' 'desktop-file-utils')
optdepends=('ffmpeg: HTML5 H264 and mp3 playback')
install=opera.install
options=(!strip)
source=("http://get.geo.opera.com/pub/${pkgname}/${pkgver}/linux/${pkgname}_${pkgver}_amd64.deb")
# alternative download
#source=("ftp://ftp.opera.com/pub/${pkgname}/${pkgver}/linux/${pkgname}_${pkgver}_amd64.deb")
#source=("http://deb.opera.com/${pkgname}/pool/non-free/o/${pkgname}/${pkgname}_${pkgver}_amd64.deb"
sha256sums=('4d4a3fdcb625dac7b3c89e1f5e943610e26c7f7ebbf93f9daf5672eb8be23741')

prepare() {
	cd ${srcdir}/

	# this is nested archive, so extract the inner tarball
	tar xJf data.tar.xz
}

package() {
	cd ${srcdir}/

	# copy to pkgdir
	cp -a usr/ "${pkgdir}/"

	# ffmpeg compatibility symlinks
	#install -d -m0755 "${pkgdir}/usr/lib/x86_64-linux-gnu/opera-developer/lib/"
	#ln -s ../../../libavcodec.so.56 "${pkgdir}/usr/lib/x86_64-linux-gnu/opera-developer/lib/libavcodec.so.55"
	#ln -s ../../../libavformat.so.56 "${pkgdir}/usr/lib/x86_64-linux-gnu/opera-developer/lib/libavformat.so.55"
	#ln -s ../../../libavutil.so.54 "${pkgdir}/usr/lib/x86_64-linux-gnu/opera-developer/lib/libavutil.so.52"

	# set suid bit for Opera sandbox
	chmod 4755 "${pkgdir}/usr/lib/x86_64-linux-gnu/opera-developer/opera_sandbox"
}

